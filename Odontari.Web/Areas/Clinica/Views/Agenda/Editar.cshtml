@model CitaEditViewModel
@{
    var pacientes = ViewBag.Pacientes as IEnumerable<dynamic>;
    var doctores = ViewBag.Doctores as IEnumerable<dynamic>;
    ViewData["Title"] = "Editar cita";
}
@section Styles {
    <link rel="stylesheet" href="~/css/agenda.css" asp-append-version="true" />
}

<div class="agenda-page">
    <div class="agenda-header mb-4">
        <h1>Editar cita</h1>
        <a asp-action="Index" asp-route-fecha="@Model.FechaHora.Date" class="btn-nueva-cita" style="background: transparent; color: var(--odon-accent); border: 1px solid var(--odon-accent);">
            ← Volver a Agenda
        </a>
    </div>
    <div asp-validation-summary="All" class="text-danger mb-3"></div>
    <div class="form-agenda-card">
        <form asp-action="Editar" asp-route-id="@Model.Id" method="post">
            <input type="hidden" asp-for="Id" />
            <div class="mb-3">
                <label asp-for="PacienteId" class="form-label">Paciente</label>
                <select asp-for="PacienteId" class="form-select" required asp-items="@(new SelectList(pacientes ?? new List<dynamic>(), "Id", "Nombre"))">
                    <option value="">-- Seleccione paciente --</option>
                </select>
            </div>
            <div class="mb-3">
                <label asp-for="DoctorId" class="form-label">Doctor</label>
                <select asp-for="DoctorId" class="form-select" required asp-items="@(new SelectList(doctores ?? new List<dynamic>(), "Id", "Nombre"))">
                    <option value="">-- Seleccione doctor --</option>
                </select>
            </div>
            <div class="mb-3">
                <label asp-for="FechaHora" class="form-label">Fecha y hora</label>
                <input asp-for="FechaHora" type="datetime-local" class="form-control" />
                <span asp-validation-for="FechaHora" class="text-danger"></span>
            </div>
            <div class="mb-3">
                <label asp-for="DuracionMinutos" class="form-label">Duración en consultorio (minutos)</label>
                <select asp-for="DuracionMinutos" class="form-select">
                    <option value="15" selected="@(Model.DuracionMinutos == 15)">15 min</option>
                    <option value="30" selected="@(Model.DuracionMinutos == 30)">30 min</option>
                    <option value="45" selected="@(Model.DuracionMinutos == 45)">45 min</option>
                    <option value="60" selected="@(Model.DuracionMinutos == 60)">1 hora</option>
                    <option value="90" selected="@(Model.DuracionMinutos == 90)">1 h 30 min</option>
                    <option value="120" selected="@(Model.DuracionMinutos == 120)">2 horas</option>
                </select>
            </div>
            <div class="mb-4">
                <label asp-for="Motivo" class="form-label">Motivo / Procedimiento</label>
                <input asp-for="Motivo" class="form-control" placeholder="Ej. Limpieza general, Revisión" />
            </div>
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">Guardar cambios</button>
                <a asp-action="Index" asp-route-fecha="@Model.FechaHora.Date" class="btn btn-outline-secondary">Cancelar</a>
            </div>
        </form>
    </div>
</div>
@section Scripts { <partial name="_ValidationScriptsPartial" /> }
